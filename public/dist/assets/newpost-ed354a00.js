import{o as n,c as i,a as t,_ as S,r as d,f as l,t as P,e as _,b as h,h as g,F as V,i as A,E as b,I as E,D as $,d as B,n as m,w,J as I,g as q,p as L,k as R}from"./index-d2762744.js";import{E as W}from"./Editor-8afb130e.js";import"./template-fe9f404d.js";import{d as X}from"./documentIcon-3fbcb264.js";import{r as H}from"./XMarkIcon-360d76fa.js";import{r as F,a as J}from"./PhotoIcon-e636a9c2.js";import{u as O}from"./switch-8bb682d4.js";function G(o,e){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{d:"M5.85 3.5a.75.75 0 00-1.117-1 9.719 9.719 0 00-2.348 4.876.75.75 0 001.479.248A8.219 8.219 0 015.85 3.5zM19.267 2.5a.75.75 0 10-1.118 1 8.22 8.22 0 011.987 4.124.75.75 0 001.48-.248A9.72 9.72 0 0019.266 2.5z"}),t("path",{"fill-rule":"evenodd",d:"M12 2.25A6.75 6.75 0 005.25 9v.75a8.217 8.217 0 01-2.119 5.52.75.75 0 00.298 1.206c1.544.57 3.16.99 4.831 1.243a3.75 3.75 0 107.48 0 24.583 24.583 0 004.83-1.244.75.75 0 00.298-1.205 8.217 8.217 0 01-2.118-5.52V9A6.75 6.75 0 0012 2.25zM9.75 18c0-.034 0-.067.002-.1a25.05 25.05 0 004.496 0l.002.1a2.25 2.25 0 11-4.5 0z","clip-rule":"evenodd"})])}function Y(o,e){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z","clip-rule":"evenodd"})])}function K(o,e){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12h16.5M12 17.25h8.25"})])}function Q(o,e){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"})])}function Z(o,e){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})])}const ee={components:{XCircleIcon:Y,BellAlertIcon:G},props:["error"]},te={key:0,class:"md:w-96 w-10/12 md:px-10 fixed top-10 shadow-lg left-1/2 -translate-x-1/2 z-30 border border-blue-300 bg-gradient-to-t from-blue-500 to-blue-300 transition-all duration-500 rounded"},se={class:"flex flex-row justify-between py-3 gap-4 items-center px-3"},oe={class:"text-gray-50 text-xs px-8"};function re(o,e,p,k,s,a){const f=d("BellAlertIcon"),u=d("XCircleIcon");return p.error?(n(),i("div",te,[t("div",se,[l(f,{class:"w-10 absolute left-0 top-0 rouded-l p-2 h-full text-blue-300 bg-white/50"}),t("p",oe,P(p.error),1),l(u,{onClick:e[0]||(e[0]=v=>o.$emit("closeError")),class:"w-8 text-blue-50 absolute right-4 hover:text-blue-100 hover:ring rounded-full hover:ring-blue-100 transition-all"})])])):_("",!0)}const ne=S(ee,[["render",re]]),le={components:{XMarkIcon:H},data(){return{allImages:[],selectedImage:"",documentImage:X}},methods:{getAllImages(){h.get("https://bluvardadmin.onrender.com/files").then(o=>{this.allImages=o.data,this.records=o.data})},showimage(o){return"https://bluvard.org/assets/"+o}},mounted(){this.getAllImages()},computed:{getImages(){return this.allImages.map(o=>"https://bluvard.org/assets/"+o)}}},ie={class:"border"},ae={class:"border-b p-3 w-full flex items-center justify-between text-gray-500"},de={class:"p-3 grid grid-cols-3 items-start h-72 overflow-y-auto"},ce=["for"],pe=["id","value","onClick"],ue=["src","alt"];function ge(o,e,p,k,s,a){const f=d("XMarkIcon");return n(),i("div",ie,[t("div",ae,[g("All Images "),l(f,{class:"h-full w-6 bg-white rounded-full p-1 text-red-400 font-bold shadow cursor-pointer",onClick:e[0]||(e[0]=u=>o.$emit("close"))})]),t("div",de,[(n(!0),i(V,null,A(s.allImages,(u,v)=>(n(),i("label",{for:v,key:v},[b(t("input",{type:"radio",id:v,class:"hidden",value:u.file_name,"onUpdate:modelValue":e[1]||(e[1]=y=>s.selectedImage=y),onClick:y=>o.$emit("chooseImage",a.showimage(u.file_name))},null,8,pe),[[E,s.selectedImage]]),t("img",{src:u.mime_type.split("/")[0]=="image"?a.showimage(u.file_name):s.documentImage,alt:u,class:"h-full border object-cover object-left hover:opacity-70"},null,8,ue)],8,ce))),128))])])}const me=S(le,[["render",ge]]);const D=$(),he={components:{editor:W,ChevronDownIcon:F,ChevronUpIcon:Q,Bars3BottomRightIcon:K,PhotoIcon:J,allImage:me,ErrorVue:ne,HomeIcon:Z,Switch:O},data(){return{options:{sidebar:{toggled:!0},summary:{toggled:!1},category:{toggled:!1},fimage:{toggled:!1},excerpt:{toggled:!1},discussion:{toggled:!1},showImageWidget:{toggled:!1}},posts:{},postID:"",author_username:"",categories:[],post_category:"",setId:!1,pageError:"",isSaved:!1,isDraft:!0}},methods:{async getNewId(){const o=B.get("userID"),e=this.$route.query.type;try{const p=await h.post("https://bluvardadmin.onrender.com/initpost",{post_author:`${o}`,post_type:e});return this.postID=p.data.insertId,p.data.insertId}catch{}},async getPostById(o){await h.get(`https://bluvardadmin.onrender.com/post/${o}`,{headers:{"cache-control":"no-cache"},cache:!1}).then(e=>{this.posts=e.data[0]}).catch(e=>{})},getUserById(o){h.get(`https://bluvardadmin.onrender.com/user/${o}`).then(e=>{this.author_username=e.data[0].username}).catch(e=>{})},getCategories(){h.get("https://bluvardadmin.onrender.com/categories").then(o=>{this.categories=o.data}).catch(o=>{})},selectedImage(o){this.posts.post_image=o},updatePost(o){let{username:e,profile_image:p,type:k,title:s,...a}=this.posts;h.post(`https://bluvardadmin.onrender.com/post/update/${o}`,a).then(f=>{D.setToast("Page update success!"),this.isSaved=!0}).catch(f=>{D.setToast("Encountered an Error! Contact Administrator.")})},async savePost(){try{this.$route.query.pid?(this.posts.post_modified=new Date,this.saveCategories(this.postID),this.posts.post_modified=new Date,this.updatePost(this.postID),await this.getPostById(this.postID)):(this.$router.push({query:{action:"edit",pid:this.postID}}),this.posts.post_status="draft",this.saveCategories(this.postID),this.updatePost(this.postID),localStorage.removeItem("setId"),await this.getPostById(this.postID))}catch{}},getPostCategories(o){h.get(`https://bluvardadmin.onrender.com/categories/${o}`).then(e=>{this.post_category=e.data[0].category_id})},saveCategories(o){h.post(`https://bluvardadmin.onrender.com/post-has-categories/${o}`,{category_id:this.post_category?this.post_category:1}).then(e=>{})},previewPage(){window.open(this.post_url,"_blank")},publishPost(){this.posts.post_status="published",this.savePost()},async getTemplates(){const o=this.$route.query.type,e=this.$route.query.templates;try{return(await h.get(`https://bluvardadmin.onrender.com/templates/${o}/${e}`)).data[0]}catch{}}},mounted(){this.getUserById(B.get("userID")),this.getCategories(),this.getPostCategories(this.postID)},async created(){if(this.$route.query.pid)this.postID=this.$route.query.pid,this.getPostById(this.postID);else{const o=await this.getTemplates();if(this.posts={...this.posts,post_content:o.template_content},localStorage.getItem("setId")){const e=JSON.parse(localStorage.getItem("setId"));this.postID=e.postId,D.setToast("You are Editing a cached copy. Save Document as Draft or Publish.")}else{const e=await this.getNewId();localStorage.setItem("setId",JSON.stringify({postId:e,date:new Date().toDateString()}))}}},computed:{post_url(){return`https://bluvard.onrender.com/blog/posts/${this.postID}`},checkCommentStatus(){return this.posts.comment_status==1}},beforeUpdate(){this.isSaved=!1,this.posts.post_status=="draft"?(this.isDraft=!0,document.title="New Post"):(this.isDraft=!1,document.title=this.posts.post_title==null?"Save Post":this.posts.post_title)}},c=o=>(L("data-v-db4c9527"),o=o(),R(),o),_e={class:"title p-2 border-b sticky top-0 bg-white"},fe={class:"mx-auto md:px-5 flex justify-between items-center"},ve=c(()=>t("p",{class:"md:text-lg text-xs text-indigo-700 font-bold"},"MANAGE POSTS",-1)),be={class:"flex md:gap-3 items-center"},xe={class:"max-md:border flex md:gap-2"},we=["disabled"],ye=["disabled"],Ie={class:"flex w-full justify-between min-h-screen bg-gray-50"},ke={class:"w-full overflow-auto"},Ce={class:"breadcrumb bg-white z-20 border-b p-3 md:px-10 px-5"},De={class:"inline-flex items-center gap-2 text-sm"},Pe=c(()=>t("p",{class:"inline"},">",-1)),Se=c(()=>t("p",null,"All",-1)),je=c(()=>t("p",{class:"inline"},">",-1)),Be=c(()=>t("button",{class:"text-slate-500 inline"},"Post",-1)),Ve={class:"content md:px-10 w-full mx-auto max-md:py-2 max-md:px-2"},Ae={class:"title relative md:top-5 max-md:mb-5 max-md:rounded-xl bg-white"},Ee={key:0,class:"settings border-l md:w-1/5 bg-gray-700 text-gray-50"},Me=c(()=>t("div",{class:"p-3 font-bold border-b border-gray-600"},"Settings",-1)),ze={class:"flex flex-col"},Ue={class:"summary group"},Te={key:0,class:"options p-3 text-xs"},Ne={class:"flex items-center justify-between gap-1 py-1"},$e=c(()=>t("p",{class:"w-2/3"},"URL",-1)),qe={class:"flex items-center justify-between gap-1 py-1"},Le=c(()=>t("p",{class:"w-2/3"},"Author",-1)),Re={class:"category group"},We={key:0,class:"options p-3 text-xs"},Xe={class:"flex flex-col justify-between gap-3 py-3"},He=["for"],Fe=["id","value"],Je={class:"featured_image group relative"},Oe={key:0,class:"options p-3 text-xs"},Ge={class:"flex flex-col justify-between gap-3 py-3"},Ye=["src"],Ke={class:"absolute bg-white top-0 w-72 -left-72 z-30"},Qe={class:"Excerpt group border-b border-gray-600"},Ze={key:0,class:"options p-3 text-xs"},et={class:"flex flex-col justify-between gap-1 py-1"},tt={for:"",class:"gap-4"},st=c(()=>t("br",null,null,-1)),ot=c(()=>t("br",null,null,-1)),rt={class:"discussion group"},nt={key:0,class:"options p-3 text-xs"},lt={class:"flex flex-col justify-between gap-3 py-3"},it={for:"comments",class:"flex gap-4"},at=c(()=>t("span",{class:"sr-only"},"enable email notifications",-1)),dt=c(()=>t("span",{"aria-hidden":"true",class:"pointer-events-none absolute bg-white w-full h-full rounded-full"},null,-1)),ct=c(()=>t("p",null,"Allow Comments",-1));function pt(o,e,p,k,s,a){const f=d("Bars3BottomRightIcon"),u=d("HomeIcon"),v=d("Router-link"),y=d("editor"),x=d("ChevronDownIcon"),j=d("router-link"),M=d("PhotoIcon"),z=d("allImage"),U=d("Switch"),T=d("ErrorVue");return n(),i("div",null,[t("div",_e,[t("div",fe,[ve,t("div",be,[t("div",xe,[t("button",{class:m(["md:border px-3 py-2 text-xs bg-white text-black",{"opacity-20":s.isSaved}]),disabled:s.isSaved,onClick:e[0]||(e[0]=(...r)=>a.savePost&&a.savePost(...r))},"Save",10,we),t("button",{class:"px-3 py-2 text-xs bg-gray-400 text-white",onClick:e[1]||(e[1]=(...r)=>a.previewPage&&a.previewPage(...r))},"Preview"),t("button",{class:m(["bg-blue-500 text-white px-3 py-2 text-xs",{"opacity-20":!s.isDraft}]),onClick:e[2]||(e[2]=(...r)=>a.publishPost&&a.publishPost(...r)),disabled:!s.isDraft},P(s.isDraft?"publish":"published"),11,ye)]),t("div",{class:"cursor-pointer p-2 flex items-center h-full w-10 ml-2 justify-center",onClick:e[3]||(e[3]=r=>s.options.sidebar.toggled=!s.options.sidebar.toggled)},[l(f,{class:"h-full"})])])])]),t("div",Ie,[t("div",ke,[t("div",Ce,[t("div",De,[l(v,{to:"/",class:"text-sm gap-2 items-center flex"},{default:w(()=>[l(u,{class:"w-4 inline"}),g("Home ")]),_:1}),Pe,l(v,{to:"/posts",class:""},{default:w(()=>[Se]),_:1}),je,Be])]),t("div",Ve,[t("div",Ae,[b(t("input",{type:"text",class:"resize-none bg-transparent md:text-2xl text-md border- border-gray-300 border-b-0 w-full font-semibold focus:outline-0 focus:ring-0 text-slate-500 align-middle",placeholder:"Add Title",id:"","onUpdate:modelValue":e[4]||(e[4]=r=>s.posts.post_title=r)},null,512),[[I,s.posts.post_title]]),l(y,{class:"editor h-96 p-5 text-sm focus:ring- focus:border-0 resize-none w-full focus:outline-0 overflow-y-auto",init:{plugins:"lists link image table code help wordcount"},modelValue:s.posts.post_content,"onUpdate:modelValue":e[5]||(e[5]=r=>s.posts.post_content=r)},null,8,["modelValue"])])])]),s.options.sidebar.toggled?(n(),i("div",Ee,[Me,t("div",ze,[t("div",Ue,[t("div",{class:"title flex p-3 justify-between items-center group-hover:bg-gray-50 group-hover:text-gray-700",onClick:e[6]||(e[6]=r=>s.options.summary.toggled=!s.options.summary.toggled)},[g("Summary "),l(x,{class:m(["w-6 transition-all",{"w-6 -rotate-180 transition-all":s.options.summary.toggled}])},null,8,["class"])]),s.options.summary.toggled?(n(),i("div",Te,[t("div",Ne,[$e,b(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=r=>a.post_url=r),disabled:"",id:"",class:"text-xs w-full text-gray-700"},null,512),[[I,a.post_url]])]),t("div",qe,[Le,b(t("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=r=>s.author_username=r),disabled:"",id:"",class:"text-xs w-full text-gray-700"},null,512),[[I,s.author_username]])])])):_("",!0)]),t("div",Re,[t("div",{class:"title flex p-3 justify-between items-center group-hover:bg-gray-50 group-hover:text-gray-700",onClick:e[9]||(e[9]=r=>s.options.category.toggled=!s.options.category.toggled)},[g("category "),l(x,{class:m(["w-6 transition-all",{"w-6 -rotate-180 transition-all":s.options.category.toggled}])},null,8,["class"])]),s.options.category.toggled?(n(),i("div",We,[t("div",Xe,[(n(!0),i(V,null,A(s.categories,(r,C)=>(n(),i("label",{for:C,class:"flex gap-4",key:C},[b(t("input",{type:"radio",name:"category",id:C,value:r.id,"onUpdate:modelValue":e[10]||(e[10]=N=>s.post_category=N)},null,8,Fe),[[E,s.post_category]]),t("p",null,P(r.title),1)],8,He))),128))]),l(j,{to:"/settings/category",class:"py-2 underline text-blue-600"},{default:w(()=>[g("Add new Category")]),_:1})])):_("",!0)]),t("div",Je,[t("div",{class:"title flex p-3 justify-between items-center group-hover:bg-gray-50 group-hover:text-gray-700",onClick:e[11]||(e[11]=r=>s.options.fimage.toggled=!s.options.fimage.toggled)},[g("Featured Images "),l(x,{class:m(["w-6 transition-all",{"w-6 -rotate-180 transition-all":s.options.fimage.toggled}])},null,8,["class"])]),s.options.fimage.toggled?(n(),i("div",Oe,[t("div",Ge,[t("label",{for:"",class:"relative flex items-center min-h-full h-52 justify-center gap-4 bg-gray-200 border-dashed border-black p-7 cursor-pointer border",onClick:e[12]||(e[12]=r=>s.options.showImageWidget.toggled=!0)},[l(M,{class:"w-10 text-white"}),t("img",{src:s.posts.post_image,class:"absolute inset-0 w-full h-full object-cover object-top",alt:""},null,8,Ye)])]),t("div",Ke,[s.options.showImageWidget.toggled?(n(),q(z,{key:0,onClose:e[13]||(e[13]=r=>s.options.showImageWidget.toggled=!s.options.showImageWidget.toggled),onChooseImage:a.selectedImage},null,8,["onChooseImage"])):_("",!0)]),l(j,{to:"/media/add",class:"py-2 underline text-blue-600"},{default:w(()=>[g("Add images")]),_:1})])):_("",!0)]),t("div",Qe,[t("div",{class:"title flex p-3 justify-between items-center group-hover:bg-gray-50 group-hover:text-gray-700",onClick:e[14]||(e[14]=r=>s.options.excerpt.toggled=!s.options.excerpt.toggled)},[g("Excerpt "),l(x,{class:m(["w-6 transition-all",{"w-6 -rotate-180 transition-all":s.options.excerpt.toggled}])},null,8,["class"])]),s.options.excerpt.toggled?(n(),i("div",Ze,[t("div",et,[t("label",tt,[g(" Write an Excerpt "),st,ot,b(t("textarea",{name:"",id:"",class:"w-full resize-none rounded border-slate-500 text-gray-700","onUpdate:modelValue":e[15]||(e[15]=r=>s.posts.post_excerpt=r)},null,512),[[I,s.posts.post_excerpt]])])])])):_("",!0)]),t("div",rt,[t("div",{class:"title flex p-3 justify-between items-center group-hover:bg-gray-50 group-hover:text-gray-700",onClick:e[16]||(e[16]=r=>s.options.discussion.toggled=!s.options.discussion.toggled)},[g("Discussion "),l(x,{class:m(["w-6 transition-all",{"w-6 -rotate-180 transition-all":s.options.discussion.toggled}])},null,8,["class"])]),s.options.discussion.toggled?(n(),i("div",nt,[t("div",lt,[t("label",it,[l(U,{modelValue:s.posts.comment_status,"onUpdate:modelValue":e[17]||(e[17]=r=>s.posts.comment_status=r),id:"comments",class:"flex-shrink-0 group relative rounded-full inline-flex items-center justify-center h-5 w-10 cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},{default:w(()=>[at,dt,t("span",{"aria-hidden":"true",class:m([s.posts.comment_status==1?"bg-indigo-600":"bg-gray-500","pointer-events-none absolute h-4 w-9 mx-auto rounded-full transition-colors ease-in-out duration-200"])},null,2),t("span",{"aria-hidden":"true",class:m([s.posts.comment_status==1?"translate-x-5":"translate-x-0","pointer-events-none absolute left-0 inline-block h-5 w-5 border border-gray-200 rounded-full bg-white shadow transform ring-0 transition-transform ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue"]),ct])])])):_("",!0)])])])):_("",!0)]),l(T,{error:s.pageError,onCloseError:e[18]||(e[18]=r=>s.pageError="")},null,8,["error"])])}const bt=S(he,[["render",pt],["__scopeId","data-v-db4c9527"]]);export{bt as default};
